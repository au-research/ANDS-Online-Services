<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Vocab Widget Demonstrator</title>

    <script type="text/javascript"
	    src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js"></script>
    <script type="text/javascript" src="js/vocab_widget.js"></script>
    <link rel="stylesheet" type="text/css" href="css/vocab_widget.css" />
    <style>
      body
      {
        font-family: Verdana;
        font-size:12px;
        background-color:#efefef;
        margin-top:100px;
      }
      div.container
      {
        width: 750px;
        height: 500px;
        margin:auto;
      }

      div.formarea
      {
        width: 500px;
        padding:30px;
        border: 1px solid #999;
      }

      form
      {
        font-size:12px;
      }

      div.formfields
      {
        padding:20px;
	font-size:10px;
      }

      dl dt {
        font-weight:bold;
      }
      dl dd {
        margin-left:0px;
        margin-bottom:10px;
      }

      fieldset legend { font-size: 14px; font-weight: bold; }

      .note { color: #999; background-color: #333; padding:0.5em; display:none; }

      .note pre { color: #ccc; }

      .note-toggle { background-color: orange; border-color: orange; border-radius: 5px; font-weight: bold; }

    </style>
  </head>
  <body>

    <div class="container">

      <div class="formarea">
	<h1>Vocab Widget Demonstrator</h1>
        <h2>Example Data Classification/Submission System</h2>
        <hr/>

        <div class="formfields">
          <form id="searchform">
	    <fieldset>
	      <legend>Details</legend>
              <dl>
		<dt>Chief Investigator Name:</dt>
		<dd><input type="text" name="cia_name" value="Joe Bloggs" size="40" /></dd>

		<dt>Project Name:</dt>
		<dd><input type="text" name="project_name" value="Coral community and extent mapping of the Wide Bay - Burnett Coastal fringe project" size="40" /></dd>
	      </dl>
	    </fieldset>
	    <fieldset>
	      <legend>Vocab widget: ANZSRC searching <button type="link" class="note-toggle">?</button></legend>
	      <div class="note">
		This form section is using the widget in the 'search' helper mode:
		<pre>
$("#anzsrc-vocab").vocab_widget({
    mode: 'search',
    cache: false,
    repository: 'anzsrc-for',
    target_field: 'label'});
		</pre>
	      </div>
	      <dl>
		<dt>ANZSRC Field of Research:</dt>
		<dd><input type="text" id="anzsrc-vocab" name="anzsrc-for" value="" size="40" /></dd>
	      </dl>

	      <i>(autocomplete; begin typing something (e.g. "BIOL"))</i>
	    </fieldset>
	    <fieldset>
	      <legend>Vocab widget: RIFCS narrowing <button type="link" class="note-toggle">?</button></legend>
	      <div class="note">
		This form section is using the widget in the 'narrow' helper mode on a standard selection list:
		<pre>
$("#rifcs-idtype").vocab_widget({
    mode:"narrow",
    mode_params:"http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType",
    repository:"rifcs",
    cache: false,
    fields: ['definition'],
    target_field: 'label'});
		</pre>
	      </div>
	      <dl>
		<dt>RIFCS Identifier Type:</dt>
		<dd><select id="rifcs-idtype" name="rifcs-id-for" value=""></select></dd>
	      </dl>
	    </fieldset>
	    <fieldset>
	      <legend>Vocab widget: RIFCS narrowing w/ autocomplete <button type="link" class="note-toggle">?</button></legend>
	      <div class="note">
		This form section is using the widget in the 'narrow' helper mode on a autocomplete-style text box:
		<pre>
$("#rifcs-idtype-input").vocab_widget({
    mode:"narrow",
    mode_params:"http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType",
    repository:"rifcs",
    cache: false,
    fields: ['label', 'definition', 'about'],
    target_field: 'label'});
		</pre>
	      </div>
	      <dl>
		<dt>RIFCS Identifier Type:</dt>
		<dd><input type="text" size="40" id="rifcs-idtype-input" name="rifcs-id-for-input" value="" /></dd>
	      </dl>
	      <i>(autocomplete; begin typing something (e.g. "ABN"), or press the down arrow to browse selections)</i>
	    </fieldset>
	    <fieldset>
	      <legend>Vocab widget: advanced use  <button type="link" class="note-toggle">?</button></legend>
	      <div class="note">
		This form section is using the widget with no helpers; it outputs a list of known <code>rifcs</code> identifier types:
		<pre>
var elem = $("#vocab-advanced");
var widget = elem.vocab_widget({mode:'advanced'});
widget.vocab_widget('repository', 'rifcs');
widget.vocab_widget('cache', false);
//set up some handlers
elem.on('narrow.vocab.ands', function(event, data) {
    var list = elem.append('&lt;ul /&gt;');
    $.each(data.items, function(idx, e) {
	var link = $('&lt;a href="' + e['about'] + '"&gt;' +
		     e['label'] + '&lt;/a&gt;');
	var item = $('&lt;li /&gt;');
	item.append(link).append(' (' + e.definition + ')');
	item.data('data', e);
	list.append(item);
    });
});
elem.on('error.vocab.ands', function(event, xhr) {
    elem.addClass('error')
	.empty()
	.text('There was an error retrieving vocab data: ' + xhr);
});

//now, perform the vocab lookup
widget.vocab_widget('narrow',
		    'http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType');
		</pre>
	      </div>
	      <div id="vocab-advanced">
		<p>RIFCS Identifier types:</p>
	      </div>
	    </fieldset>
	    <fieldset>
	      <legend>Vocab widget: tree mode  <button type="link" class="note-toggle">?</button></legend>
	      <div class="note">
		This section illustrates the use of the vocab widget as a tree browse list. Clicking a listed term toggles the state of that branch, fetching child data as required. A 'treeselect.vocab.ands' even gets fired when a list item (but not it's icon) is clicked.
		<pre>
$("#vocab-tree").vocab_widget({mode:'tree',
			       repository:'anzsrc-for'})
    .on('treeselect.vocab.ands', function(event) {
	var target = $(event.target);
	var data = target.data('vocab');
	alert('You clicked ' + data.label + '\r\n<' + data.about + '>');
    });
</pre>
	      </div>
	      <div id="vocab-tree">
	      </div>
	    </fieldset>
            <p><input type="submit"/></p>
          </form>
        </div>
      </div>
    </div>

    <script type="text/javascript">
      /* this handler is for the plugin */
      $(document).ready(function() {
	  function searchmode() {
	       $("#anzsrc-vocab").vocab_widget({mode: 'search',
						cache: false,
						repository: 'anzsrc-for',
						target_field: 'label'});
	  }

	  function narrowmode() {
	      $("#rifcs-idtype").vocab_widget({mode:"narrow",
	       				       mode_params:"http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType",
	       				       repository:"rifcs",
	       				       cache: false,
	       				       fields: ['definition'],
	       				       target_field: 'label'});
	      $("#rifcs-idtype-input").vocab_widget({mode:"narrow",
						     mode_params:"http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType",
						     repository:"rifcs",
						     cache: false,
						     fields: ['label', 'definition', 'about'],
						     target_field: 'label'});
	  }

	  function advancedmode() {
	      var elem = $("#vocab-advanced");
	      var widget = elem.vocab_widget({mode:'advanced'});
	      widget.vocab_widget('repository', 'rifcs');
	      widget.vocab_widget('cache', false);
	      //set up some handlers
	      elem.on('narrow.vocab.ands', function(event, data) {
		  var list = elem.append('<ul />');
		  $.each(data.items, function(idx, e) {
		      var link = $('<a href="' + e['about'] + '">' +
				   e['label'] + '</a>');
		      var item = $('<li />');
		      item.append(link).append(' (' + e.definition + ')');
		      item.data('data', e);
		      list.append(item);
		  });
	      });
	      elem.on('error.vocab.ands', function(event, xhr) {
		  elem.addClass('error')
		      .empty()
		      .text('There was an error retrieving vocab data: ' + xhr);
	      });

	      //now, perform the vocab lookup
	      widget.vocab_widget('narrow',
				  'http://purl.org/au-research/vocabulary/RIFCS/1.4/RIFCSIdentifierType');
	  }

	  function treemode() {
	  $("#vocab-tree").vocab_widget({mode:'tree',
					 repository:'anzsrc-for'})
		  .on('treeselect.vocab.ands', function(event) {
		      var target = $(event.target);
		      var data = target.data('vocab');
		      alert('You clicked ' + data.label + '\r\n<' + data.about + '>');
		  });
	  }

	  searchmode();
	  narrowmode();
	  advancedmode();
	  treemode();

      });

      /* this handler is for the demonstration helpers */
      $(document).ready(function() {
	$(".note-toggle").on('click',
			       function(e) {
				 e.preventDefault();
				 var target = $(e.target);
				 var parent = target.parent().parent();
				 var note = parent.find("div.note");
				 if (note.is(":visible")) {
				   note.slideUp();
				   target.text('?');
				 }
				 else {
				   note.slideDown();
				   target.text('X');
				 }
				 return false;
			       });
      })
    </script>
  </body>
</html>
